    // This is your Prisma schema file,
    // learn more about it in the docs: https://pris.ly/d/prisma-schema

    // Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
    // Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

    generator client {
        provider = "prisma-client-js"
    }

    datasource db {
        provider = "postgresql"
        url      = env("DATABASE_URL")
        // directUrl = env("POSTGRES_URL_NON_POOLING")
    }

    model User {
        id        String   @id @default(uuid())
        email     String   @unique
        name      String
        password  String?
        profileImage String?
        createdAt DateTime @default(now())
        updatedAt DateTime @updatedAt

        accounts Account[]
        sessions Session[]

        currencySettings CurrencySettings?
        categories       Category[]
        transactions     Transaction[]
        monthHistories   MonthHistory[]
        yearHistories    YearHistory[]
    }

    model Account {
        id                String  @id @default(uuid())
        userId            String
        type              String
        provider          String
        providerAccountId String
        refresh_token     String? @db.Text
        access_token      String? @db.Text
        expires_at        Int?
        token_type        String?
        scope             String?
        id_token          String? @db.Text
        session_state     String?

        user User @relation(fields: [userId], references: [id], onDelete: Cascade)

        @@unique([provider, providerAccountId])
    }

    model Session {
        id           String   @id @default(uuid())
        sessionToken String   @unique
        userId       String
        expires      DateTime

        user User @relation(fields: [userId], references: [id], onDelete: Cascade)
    }

    model CurrencySettings {
        userId   String @id
        currency String @default("USD")

        user User @relation(fields: [userId], references: [id])
    }

    model Category {
        name      String
        userId    String
        icon      String
        type      String   @default("income")
        createdAt DateTime @default(now())

        user         User          @relation(fields: [userId], references: [id])
        transactions Transaction[] @relation("CategoryTransactions")

        @@id([userId, name, type])
        @@unique([userId, name, type])
    }

    model Transaction {
        id        String   @id @default(uuid())
        createdAt DateTime @default(now())
        updatedAt DateTime @updatedAt

        amount       Float
        description  String?
        date         DateTime
        userId       String
        type         String   @default("income")
        category     String
        categoryIcon String

        user        User     @relation(fields: [userId], references: [id])
        categoryRel Category @relation("CategoryTransactions", fields: [userId, category, type], references: [userId, name, type])
    }

    model MonthHistory {
        userId  String
        day     Int
        month   Int
        year    Int
        income  Float  @default(0)
        expense Float  @default(0)

        user User @relation(fields: [userId], references: [id])

        @@id([userId, day, month, year])
    }

    model YearHistory {
        userId  String
        month   Int
        year    Int
        income  Float  @default(0)
        expense Float  @default(0)

        user User @relation(fields: [userId], references: [id])

        @@id([userId, month, year])
    }
